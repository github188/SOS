# Ipsec Tool 使用

一、辅助脚本tool\_vpn\_gen.sh根据配置引导配置第三方配置

```
root@SOS:~# tool_vpn_gen.sh ipsec
Ipsec vpn设备地址类型（1为域名，2为动态ip,其它为固定ip）：
被测试设备的wan地址：
工具端的外网ip地址(从此IP地址起始,外网IP地址会递增上去)：
认证方式（0为预共享，1为商密认证，其它数字为国密认证）：
设备端已导入国密证书配置中引用的证书id（数字）：
设备端已导入国密证书配置中引用的证书id（数字）：
IPSEC VPN模式（main:主模式、aggr:野蛮模式）：
DH群（1|2|5|14-18）：
第一阶段的生存期（600-864000）：
IPSEC VPN第一阶段采用认证算法（选项：MD5|SHA1|SHA2-256|SHA2-384|SHA2-512|SM3）：
IPsec VPN第一阶段采用加密算法（选项：DES|3DES|AES|AES192|AES256|SANGFOR_DES|SM4）：
第二阶段的生存期时间（600-864000）：
是否启用DPD（1为禁用,其它为启用）
DPD发包间隔时间（5-60）：
DPD发包间隔次数（1-6）：
----配置第二阶段的出入站策略--------
被测试设备的内网ip(建议内网一个IP地址起始.ip地址会递增):
被测试设备的内网ip掩码（输入255.255.255.255）:
工具端的内网IP地址(建议内网一个IP地址起始.ip地址会递增)：
测试IPsec VPN条数：
工具对接外网接口名称(默认eth1)：
如果需要把上次新增累加一起数据才需要添加这个参数，不然就默认为空,当前脚本针对配置合并没处理,需要手动
上次新增到多少配置,这次从这条数目开始
```

二、配置完成后，在/var/ipsec.log文件取执行命令

三、执行上面日志的命令成功后，在/tmp/VPNTOOL/目录下取3个配置文件导入测试设备中/etc/sinfor/dlan目录下

四、重启被测试设备的lmdlan,会通过命令工具让其配置生效

